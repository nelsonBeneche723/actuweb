{% extends 'base.html' %}

{% block title %}AI Assistant {% endblock %}

{% block link %}
<link rel="icon" href="{{ url_for('static', filename='images/ai_artificial_intelli.ico') }}" type="image/x-icon">
{% endblock %}

{% block content%}
<style>

    /* Styles pour les écrans de bureau */
@media (min-width: 768px) {
  h2 {
    font-size: 1rem;
    margin-bottom: 1rem;
  }

  form {
    display: flex;
    align-items:center;
    justify-content: center;
    margin-bottom: 2rem;
    margin-top: 2rem;
  }

  input[type="text"] {
    font-size: 1.2rem;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    border: 1px solid #ccc;
    margin-right: 1rem;
  }

  button[type="submit"] {
    font-size: 1.2rem;
    padding: 0.5rem 1rem;
    background-color: #007bff;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

  .reponse-container {
    max-width: 800px;
    margin: 0 auto;
  }

  .reponse-container p {
    font-size: 1.2rem;
    line-height: 1.5;
  }
}

/* Styles pour les appareils mobiles */
@media (max-width: 767px) {
  h2 {
    font-size: 1.2rem;
    margin-bottom: 0.5rem;
  }

  form {
    flex-direction: column;
    align-items: center;
    margin-bottom: 1rem;
  }

  input[type="text"] {
    font-size: 1rem;
    padding: 0.5rem;
    border-radius: 5px;
    border: 1px solid #ccc;
    width: 100%;
    margin-bottom: 1rem;
  }

  button[type="submit"] {
    font-size: 1rem;
    padding: 0.5rem 1rem;
    background-color: #007bff;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

  .reponse-container {
    padding: 0 1rem;
  }

  .reponse-container p {
    font-size: 1rem;
    line-height: 1.4;
  }

}

  textarea {width:500px; height:220px;}

@media (max-width: 600px) {
#prompttextarea{
    width:100%;
    margin-bottom:15px;
    }
}
</style>
<!--    <h2>Assistant IA</h2>-->

    <!-- Formulaire de saisi -->
    <form action="/assistant-ia" method="POST" id="promptForm">
         <textarea name="prompt" placeholder="Votre question..." id ="prompttextarea" required></textarea>
<!--        <input type="text" id="prompt" name="prompt" required style="width: 70%; padding: 10px;" placeholder="Entrer votre prompt...">-->
        <button type="submit">Envoyer</button>
    </form>
  <!-- Affichage de la réponse -->
    <div id="response">

    </div>


<!--        {% for rep in reponses %}-->
<!--            <h2>Réponse de l'assistant IA :</h2>-->
<!--            <p>{{rep.reponse}}</p>-->
<!--        {% endfor %}-->



<script>
document.getElementById('promptForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const formData = new FormData(e.target);
    const responseDiv = document.getElementById('response');
    responseDiv.innerHTML = ''; // Vider les résultats précédents

    try {
        const response = await fetch('/assistant-ia', {
            method: 'POST',
            body: formData
        });

        const reader = response.body.getReader();
        const decoder = new TextDecoder();

        while (true) {
            const { done, value } = await reader.read();
            if (done) break;

            const text = decoder.decode(value);
            responseDiv.innerHTML += text;
        }
    } catch (error) {
        responseDiv.innerHTML = `<p>Erreur : ${error.message}</p>`;
    }
});
</script>
{% endblock %}